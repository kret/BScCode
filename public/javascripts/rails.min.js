(function(b){var a;b.rails=a={CSRFProtection:function(d){var c=b('meta[name="csrf-token"]').attr("content");if(c){d.setRequestHeader("X-CSRF-Token",c)}},fire:function(g,c,f){var d=b.Event(c);g.trigger(d,f);return d.result!==false},handleRemote:function(g){var i,d,h,c=g.data("type")||(b.ajaxSettings&&b.ajaxSettings.dataType);if(a.fire(g,"ajax:before")){if(g.is("form")){i=g.attr("method");d=g.attr("action");h=g.serializeArray();var f=g.data("ujs:submit-button");if(f){h.push(f);g.data("ujs:submit-button",null)}}else{i=g.data("method");d=g.attr("href");h=null}b.ajax({url:d,type:i||"GET",data:h,dataType:c,beforeSend:function(k,j){if(j.dataType===undefined){k.setRequestHeader("accept","*/*;q=0.5, "+j.accepts.script)}return a.fire(g,"ajax:beforeSend",[k,j])},success:function(k,j,l){g.trigger("ajax:success",[k,j,l])},complete:function(k,j){g.trigger("ajax:complete",[k,j])},error:function(l,j,k){g.trigger("ajax:error",[l,j,k])}})}},handleMethod:function(h){var d=h.attr("href"),j=h.data("method"),f=b("meta[name=csrf-token]").attr("content"),i=b("meta[name=csrf-param]").attr("content"),g=b('<form method="post" action="'+d+'"></form>'),c='<input name="_method" value="'+j+'" type="hidden" />';if(i!==undefined&&f!==undefined){c+='<input name="'+i+'" value="'+f+'" type="hidden" />'}g.hide().append(c).appendTo("body");g.submit()},disableFormElements:function(c){c.find("input[data-disable-with], button[data-disable-with]").each(function(){var d=b(this),f=d.is("button")?"html":"val";d.data("ujs:enable-with",d[f]());d[f](d.data("disable-with"));d.attr("disabled","disabled")})},enableFormElements:function(c){c.find("input[data-disable-with]:disabled, button[data-disable-with]:disabled").each(function(){var d=b(this),f=d.is("button")?"html":"val";if(d.data("ujs:enable-with")){d[f](d.data("ujs:enable-with"))}d.removeAttr("disabled")})},allowAction:function(c){var d=c.data("confirm");return !d||(a.fire(c,"confirm")&&confirm(d))},blankInputs:function(f,d){var g=false,c=d||"input";f.find(c).each(function(){if(!b(this).val()){g=true;return false}});return g},nonBlankInputs:function(g,d){var f=false,c=d||"input";g.find(c).each(function(){if(b(this).val()){f=true;return false}});return f},stopEverything:function(c){c.stopImmediatePropagation();return false},callFormSubmitBindings:function(d){var c=d.data("events"),f=true;if(c!==undefined&&c.submit!==undefined){b.each(c.submit,function(g,h){if(typeof h.handler==="function"){return f=h.handler(h.data)}})}return f}};if("ajaxPrefilter" in b){b.ajaxPrefilter(function(c,f,d){a.CSRFProtection(d)})}else{b(document).ajaxSend(function(c,d){a.CSRFProtection(d)})}b("a[data-confirm], a[data-method], a[data-remote]").live("click.rails",function(d){var c=b(this);if(!a.allowAction(c)){return a.stopEverything(d)}if(c.data("remote")!==undefined){a.handleRemote(c);return false}else{if(c.data("method")){a.handleMethod(c);return false}}});b("form").live("submit.rails",function(f){var c=b(this),d=c.data("remote")!==undefined;if(!a.allowAction(c)){return a.stopEverything(f)}if(a.blankInputs(c,"input[name][required]")&&a.fire(c,"ajax:aborted:required")){return !d}if(a.nonBlankInputs(c,"input:file")){return a.fire(c,"ajax:aborted:file")}if(!b.support.submitBubbles&&a.callFormSubmitBindings(c)===false){return a.stopEverything(f)}if(d){a.handleRemote(c);return false}else{setTimeout(function(){a.disableFormElements(c)},13)}});b("form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])").live("click.rails",function(){var d=b(this);if(!a.allowAction(d)){return a.stopEverything(e)}var c=d.attr("name"),f=c?{name:c,value:d.val()}:null;d.closest("form").data("ujs:submit-button",f)});b("form").live("ajax:beforeSend.rails",function(c){if(this==c.target){a.disableFormElements(b(this))}});b("form").live("ajax:complete.rails",function(c){if(this==c.target){a.enableFormElements(b(this))}})})(jQuery);